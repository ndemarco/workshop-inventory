{% extends "base.html" %}

{% block title %}{{ module.name }} - WhereTF?{% endblock %}

{% block content %}
<div class="page-header">
    <h1>üì¶ {{ module.name }}</h1>
    <div class="header-actions">
        <a href="{{ url_for('modules.new_level', module_id=module.id) }}" class="btn btn-primary">+ Add Level</a>
        <a href="{{ url_for('modules.edit_module', module_id=module.id) }}" class="btn btn-secondary">Edit</a>
    </div>
</div>

<div class="module-details">
    {% if module.description %}
    <div class="detail-section">
        <strong>Description:</strong>
        <p>{{ module.description }}</p>
    </div>
    {% endif %}

    {% if module.location_description %}
    <div class="detail-section">
        <strong>Physical Location:</strong>
        <p>üìç {{ module.location_description }}</p>
    </div>
    {% endif %}

    <div class="detail-section">
        <strong>Statistics:</strong>
        <div class="stats-inline">
            <span class="badge">{{ levels|length }} levels</span>
            {% set total_locations = levels|map(attribute='locations')|map('length')|sum %}
            <span class="badge">{{ total_locations }} locations</span>
        </div>
    </div>
</div>

<h2>Levels</h2>

{% if levels %}
<div class="levels-list">
    {% for level in levels %}
    <div class="level-card">
        <div class="level-header">
            <h3>
                <a href="{{ url_for('modules.view_level', level_id=level.id) }}">
                    Level {{ level.level_number }}{% if level.name %} - {{ level.name }}{% endif %}
                </a>
            </h3>
            <div class="level-actions">
                <a href="{{ url_for('modules.view_level', level_id=level.id) }}" class="btn btn-sm">View</a>
                <a href="{{ url_for('modules.edit_level', level_id=level.id) }}" class="btn btn-sm">Edit</a>
            </div>
        </div>
        
        {% if level.description %}
        <p>{{ level.description }}</p>
        {% endif %}
        
        <div class="level-info">
            <span>Grid: {{ level.rows }} √ó {{ level.columns }}</span>
            <span>{{ level.locations|length }} locations</span>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <p>No levels yet. Add levels to organize storage locations.</p>
    <a href="{{ url_for('modules.new_level', module_id=module.id) }}" class="btn btn-primary">+ Add Level</a>
</div>
{% endif %}
{% endblock %}
