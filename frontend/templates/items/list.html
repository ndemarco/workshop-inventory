{% extends "base.html" %}

{% block title %}Items - WhereTF?{% endblock %}

{% block content %}
<div class="page-header">
    <h1>ðŸ“¦ Inventory Items</h1>
    <a href="{{ url_for('items.new_item') }}" class="btn btn-primary">+ Add Item</a>
</div>

<div class="filters">
    <form method="GET" class="filter-form">
        <input type="text" name="search" placeholder="Search items..." value="{{ request.args.get('search', '') }}">
        <select name="category">
            <option value="">All Categories</option>
            {% for cat in categories %}
            <option value="{{ cat }}" {% if request.args.get('category') == cat %}selected{% endif %}>{{ cat }}</option>
            {% endfor %}
        </select>
        <button type="submit" class="btn btn-secondary">Filter</button>
        <a href="{{ url_for('items.list_items') }}" class="btn btn-secondary">Clear</a>
    </form>
</div>

{% if items %}
<table class="data-table">
    <thead>
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Category</th>
            <th>Locations</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for item in items %}
        <tr>
            <td><strong>{{ item.name }}</strong></td>
            <td>{{ item.description[:100] }}{% if item.description|length > 100 %}...{% endif %}</td>
            <td>{{ item.category or '-' }}</td>
            <td>
                {% if item.item_locations %}
                    {% for il in item.item_locations %}
                        <span class="badge">{{ il.location.full_address() }}</span>
                    {% endfor %}
                {% else %}
                    <span class="text-muted">No location</span>
                {% endif %}
            </td>
            <td>
                <a href="{{ url_for('items.view_item', item_id=item.id) }}" class="btn-link">View</a>
                <a href="{{ url_for('items.edit_item', item_id=item.id) }}" class="btn-link">Edit</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="empty-state">
    <p>No items found.</p>
    <a href="{{ url_for('items.new_item') }}" class="btn btn-primary">+ Add Item</a>
</div>
{% endif %}
{% endblock %}
